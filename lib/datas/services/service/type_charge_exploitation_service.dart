import 'package:ges_op/models/models.dart';

import '../../../features/features.dart';

class TypeChargeExploitationService {
  Future<List<AnneeObject>> getAllAnnees() async {
    final anneeBox = ObjectBox.anneesBox;
    List<AnneeObject> mesAnnees = [];

    Query<AnneeObject> query = anneeBox!.query().build();
    mesAnnees = query.find();
    query.close();
    return mesAnnees;
  }

  Future<List<TypeChargeExploitationObject>>
      generateTypeChargeExploitationsIdProduit(int ProduitId) async {
    final chargeExploitationsBox = ObjectBox.chargeExploitationsBox;
    final query = chargeExploitationsBox!
        .query((ChargeExploitationObject_.produit_id.equals(ProduitId)))
        .build();
    print('-----------SERVICE PRODUIT ID ----${ProduitId}--------------');

    final mesChargeExploitationsBox = query.find();
    query.close();

    List<TypeChargeExploitationObject> listTypeChargeExploitationObject = [];

    mesChargeExploitationsBox.forEach((element) {
      listTypeChargeExploitationObject
          .removeWhere((e) => element.type_charge_exploitation_id == e.id);

      listTypeChargeExploitationObject.add(TypeChargeExploitationObject(
          id: element.type_charge_exploitation_id,
          name: element.type_charge_exploitation_name));
    });
    return listTypeChargeExploitationObject;
  }
}
