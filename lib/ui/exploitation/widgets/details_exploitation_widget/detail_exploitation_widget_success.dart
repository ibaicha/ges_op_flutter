import 'package:ges_op/features/files/Constants.dart';
import 'package:ges_op/ui/exploitation/widgets/details_exploitation_widget/detail_exploitation_lignes_widget.dart';
import 'package:http/http.dart' as http;

import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';


import '../../../../models/models.dart';
import '../../../type_charge_exploitation/widgets/type_charge_exploitations_idproduit/bloc/type_charge_exploitations_idproduit_bloc.dart';


class DetailExploitationSuccessWidget extends StatelessWidget {
  const DetailExploitationSuccessWidget({
    Key? key,
    required this.idProduit,
  }) : super(key: key);

  final int idProduit;

  @override
  Widget build(BuildContext context) {
    return BlocBuilder<TypeChargeExploitationsIdproduitBloc,
        TypeChargeExploitationsIdproduitState>(
      builder: (context, state) {
        List<TypeChargeExploitationObject> listTypeChargeExploitationObject =
            state.typeExploitationCharges;
        return Column(
          children: [
            Container(
              child: MediaQuery.removePadding(
                  context: context,
                  removeTop: true,
                  child: ListView.builder(
                      scrollDirection: Axis.vertical,
                      shrinkWrap: true,
                      itemCount: listTypeChargeExploitationObject == null
                          ? 0
                          : listTypeChargeExploitationObject.length,
                      itemBuilder: (context, index) {
                        return Container(
                          key:
                              ValueKey(listTypeChargeExploitationObject[index]),

                          margin: const EdgeInsets.only(bottom: 10, top: 12),
                          // height: 100,
                          padding: const EdgeInsets.only(
                              left: 20, right: 20, bottom: 5),
                          child: Container(
                            decoration: BoxDecoration(
                              color: Color(0xFF363f93),
                              borderRadius: const BorderRadius.only(
                                  topRight: Radius.circular(20.0)),
                              boxShadow: [
                                new BoxShadow(
                                    color: Color(0xFF363f93).withOpacity(0.3),
                                    offset: new Offset(-10.0, 10.0),
                                    blurRadius: 20.0,
                                    spreadRadius: 4.0),
                                //BoxShadow
                              ],
                            ),
                            padding: const EdgeInsets.only(
                                left: 6, top: 8.0, bottom: 6),
                            child: Column(
                              crossAxisAlignment: CrossAxisAlignment.start,
                              children: <Widget>[
                                Text(
                                  listTypeChargeExploitationObject[index].name,
                                  style: TextStyle(
                                      fontSize: 14,
                                      color: Colors.white,
                                      fontWeight: FontWeight.bold),
                                ),
                                const SizedBox(
                                  height: 2,
                                ),
                                /* -------- ICI -----------------*/

                                DetailExploitationLignesWidget(
                                  idProduit: state.idProduit,
                                  idTypeChargeExploitation:
                                      listTypeChargeExploitationObject[index]
                                          .id,
                                  idExploitation: 1,
                                ),

                                /* -------- ICI FIN -------------*/
                              ],
                            ),
                          ),
                        );
                      })),
            )
          ],
        );
      },
    );
  
  }
}
